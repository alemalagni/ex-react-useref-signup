<!-- index.html -->
<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignUp</title>
    <link rel="stylesheet" href="style.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
        const { useState } = React;
        const { createRoot } = ReactDOM;

        function ReactApp() {

            function disattivato() {
                const signUp = document.querySelector('.btn');
                signUp.classList.add('disabled')
            }

            function attivato() {
                const signUp = document.querySelector('.btn');
                signUp.classList.remove('disabled')
            }

            const [account, setAccount] = useState({
                fullName: '',
                username: '',
                password: '',
                specialisation: '',
                yearsOfExperience: 0,
                textArea: ''
            });

            function controlSubmit() {
                if (
                    account.fullName === '' ||
                    account.username === '' ||
                    account.password === '' ||
                    account.specialisation === '' ||
                    account.yearsOfExperience < 0 ||
                    account.textArea === ''
                ) {
                    alert('Compila tutti i campi correttamente');
                } else {
                    console.log(account)
                }
            }

            const letters = "abcdefghijklmnopqrstuvwxyz";
            const numbers = "0123456789";
            const symbols = `!@#$%^&*()-_=+[]{}|;:'\\",.<>?/\`~`;

            function controlUsername(username) {
                const controlUsername = document.querySelector('.controlUsername');
                const allowed = letters + letters.toUpperCase() + numbers;

                if (username.length === 0) {
                    return (
                        controlUsername.innerText = '',
                        controlUsername.style.color = 'black',
                        disattivato()
                    )
                } else if (username.length < 6) {
                    return (
                        controlUsername.innerText = 'Almeno 6 caratteri alfanumerici',
                        controlUsername.style.color = 'red',
                        disattivato()
                    )
                } else {
                    let control = true;
                    for (let i = 0; i < username.length; i++) {
                        let char = username[i];
                        if (!allowed.includes(char)) control = false;
                    }

                    if (control) {
                        return (
                            controlUsername.innerText = 'Username valido',
                            controlUsername.style.color = 'green',
                            attivato()
                        )
                    } else {
                        return (
                            controlUsername.innerText = 'Username non valido',
                            controlUsername.style.color = 'red'
                        );;
                    }
                }
            }

            function controlPassword(password) {
                const controlPassword = document.querySelector('.controlPassword');
                let hasLetter = false;
                let hasNumber = false;
                let hasSymbol = false;

                for (let i = 0; i < password.length; i++) {
                    let char = password[i];
                    if (letters.includes(char) || letters.toUpperCase().includes(char)) hasLetter = true;
                    else if (numbers.includes(char)) hasNumber = true;
                    else if (symbols.includes(char)) hasSymbol = true;
                }

                if (password.length === 0) {
                    return (
                        controlPassword.innerText = '',
                        controlPassword.style.color = 'black',
                        disattivato()
                    )
                } else if (password.length < 8) {
                    return (
                        controlPassword.innerText = 'Almeno 8 caratteri',
                        controlPassword.style.color = 'red',
                        disattivato()
                    )
                } else if (!hasLetter || !hasNumber || !hasSymbol) {
                    return (
                        controlPassword.innerText = 'Almeno una lettera, un numero e un simbolo',
                        controlPassword.style.color = 'red',
                        disattivato()
                    )
                } else {
                    return (
                        controlPassword.innerText = 'Password valida',
                        controlPassword.style.color = 'green',
                        attivato()
                    )
                }
            }

            function controlTextArea(textArea) {
                const controlTextArea = document.querySelector('.controlTextArea');

                if (textArea.length === 0) {
                    return (
                        controlTextArea.innerText = '',
                        controlTextArea.style.color = 'black',
                        disattivato()
                    )
                } else if (textArea.length < 100) {
                    return (
                        controlTextArea.innerText = 'Almeno 100 caratteri',
                        controlTextArea.style.color = 'red',
                        disattivato()
                    )
                } else if (textArea.length > 1000) {
                    return (
                        controlTextArea.innerText = 'Massimo 1000 caratteri',
                        controlTextArea.style.color = 'red',
                        disattivato()
                    )
                } else {
                    return (
                        controlTextArea.innerText = 'Descrizione valida',
                        controlTextArea.style.color = 'green',
                        attivato()
                    )
                }
            }

            function changeTextNumber(textLength) {
                const textNumber = document.querySelector('.textNumber');
                textNumber.innerText = textLength;

                if (textLength < 100 || textLength > 1000) {
                    textNumber.style.color = 'red';
                } else {
                    textNumber.style.color = 'black';
                }
            }

            return (
                <div style={{ display: 'flex', flexFlow: 'column', alignItems: 'start', paddingTop: '30px', gap: '10px', paddingLeft: '45vw' }}>
                    <div className="fullName">
                        <span>Nome completo:</span>
                        <div>
                            <div>
                                <input
                                    type="text"
                                    value={account.fullName}
                                    onChange={(e) =>
                                        setAccount({
                                            ...account,
                                            fullName: e.target.value
                                        })
                                    }
                                />
                            </div>
                        </div>
                    </div>
                    <div>
                        <span>Username:</span>
                        <div style={{ display: 'flex', gap: '20px' }}>
                            <div>
                                <input
                                    type="text"
                                    onChange={(e) => {
                                        setAccount({
                                            ...account,
                                            username: e.target.value
                                        })
                                        controlUsername(e.target.value);
                                    }
                                    }
                                />
                            </div>
                            <div>
                                <span className='controlUsername'></span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <span>Password:</span>
                        <div style={{ display: 'flex', gap: '20px' }}>
                            <div>
                                <input
                                    type="password"
                                    onChange={(e) => {
                                        setAccount({
                                            ...account,
                                            password: e.target.value
                                        })
                                        controlPassword(e.target.value);
                                    }
                                    }
                                />
                            </div>
                            <div>
                                <span className='controlPassword'></span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <span>Specializzazione:</span>
                        <div>
                            <select
                                onChange={(e) =>
                                    setAccount({
                                        ...account,
                                        specialisation: e.target.value
                                    })
                                }
                            >
                                <option value="">-- Seleziona --</option>
                                <option value="Full stack">Full stack</option>
                                <option value="Frontend">Frontend</option>
                                <option value="Backend">Backend</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <span>Anni di esperienza:</span>
                        <div>
                            <input
                                type="number"
                                onChange={(e) =>
                                    setAccount({
                                        ...account,
                                        yearsOfExperience: e.target.value
                                    })
                                }
                            />
                        </div>
                    </div>
                    <div>
                        <div style={{ display: 'flex', justifyContent: 'space-between', width: '300px' }}>
                            <span>Breve descrizione:</span>
                            <span className='textNumber'></span>
                        </div>

                        <div style={{ display: 'flex', gap: '20px' }}>
                            <div>
                                <textarea style={{ padding: '10px', width: '300px', height: '100px', resize: 'vertical', lineHeight: '1.4' }}
                                    onChange={(e) => {
                                        setAccount({
                                            ...account,
                                            textArea: e.target.value
                                        });
                                        controlTextArea(e.target.value);
                                        changeTextNumber(e.target.value.length);
                                    }}
                                />
                            </div>
                            <div>
                                <span className='controlTextArea'></span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <button
                            type="button"
                            className="btn btn-primary"
                            onClick={() => controlSubmit()}>Sign Up</button>
                    </div>
                </div>
            )
        }

        const root = createRoot(document.querySelector('.root'));
        root.render(<ReactApp />);
    </script>
</head>

<body>
    <div class="root"></div>
</body>

</html>